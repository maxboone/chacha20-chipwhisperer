   1              		.cpu cortex-m0
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 4
   9              		.eabi_attribute 34, 0
  10              		.eabi_attribute 18, 4
  11              		.file	"chacha20.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.chacha20_quarterround,"ax",%progbits
  16              		.align	1
  17              		.arch armv6s-m
  18              		.syntax unified
  19              		.code	16
  20              		.thumb_func
  21              		.fpu softvfp
  23              	chacha20_quarterround:
  24              	.LVL0:
  25              	.LFB3:
  26              		.file 1 "./lib/shiffthq/src/chacha20.c"
   1:./lib/shiffthq/src/chacha20.c **** #include <stdint.h>
   2:./lib/shiffthq/src/chacha20.c **** #include <string.h>
   3:./lib/shiffthq/src/chacha20.c **** #include "chacha20.h"
   4:./lib/shiffthq/src/chacha20.c **** 
   5:./lib/shiffthq/src/chacha20.c **** static inline void u32t8le(uint32_t v, uint8_t p[4]) {
   6:./lib/shiffthq/src/chacha20.c ****     p[0] = v & 0xff;
   7:./lib/shiffthq/src/chacha20.c ****     p[1] = (v >> 8) & 0xff;
   8:./lib/shiffthq/src/chacha20.c ****     p[2] = (v >> 16) & 0xff;
   9:./lib/shiffthq/src/chacha20.c ****     p[3] = (v >> 24) & 0xff;
  10:./lib/shiffthq/src/chacha20.c **** }
  11:./lib/shiffthq/src/chacha20.c **** 
  12:./lib/shiffthq/src/chacha20.c **** static inline uint32_t u8t32le(uint8_t p[4]) {
  13:./lib/shiffthq/src/chacha20.c ****     uint32_t value = p[3];
  14:./lib/shiffthq/src/chacha20.c **** 
  15:./lib/shiffthq/src/chacha20.c ****     value = (value << 8) | p[2];
  16:./lib/shiffthq/src/chacha20.c ****     value = (value << 8) | p[1];
  17:./lib/shiffthq/src/chacha20.c ****     value = (value << 8) | p[0];
  18:./lib/shiffthq/src/chacha20.c **** 
  19:./lib/shiffthq/src/chacha20.c ****     return value;
  20:./lib/shiffthq/src/chacha20.c **** }
  21:./lib/shiffthq/src/chacha20.c **** 
  22:./lib/shiffthq/src/chacha20.c **** static inline uint32_t rotl32(uint32_t x, int n) {
  23:./lib/shiffthq/src/chacha20.c ****     // http://blog.regehr.org/archives/1063
  24:./lib/shiffthq/src/chacha20.c ****     return x << n | (x >> (-n & 31));
  25:./lib/shiffthq/src/chacha20.c **** }
  26:./lib/shiffthq/src/chacha20.c **** 
  27:./lib/shiffthq/src/chacha20.c **** // https://tools.ietf.org/html/rfc7539#section-2.1
  28:./lib/shiffthq/src/chacha20.c **** static void chacha20_quarterround(uint32_t *x, int a, int b, int c, int d) {
  27              		.loc 1 28 76 view -0
  28              		.cfi_startproc
  29              		@ args = 4, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  29:./lib/shiffthq/src/chacha20.c ****     x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a], 16);
  31              		.loc 1 29 5 view .LVU1
  28:./lib/shiffthq/src/chacha20.c ****     x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a], 16);
  32              		.loc 1 28 76 is_stmt 0 view .LVU2
  33 0000 70B5     		push	{r4, r5, r6, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 16
  36              		.cfi_offset 4, -16
  37              		.cfi_offset 5, -12
  38              		.cfi_offset 6, -8
  39              		.cfi_offset 14, -4
  40              		.loc 1 29 10 view .LVU3
  41 0002 8D00     		lsls	r5, r1, #2
  42              		.loc 1 29 14 view .LVU4
  43 0004 9100     		lsls	r1, r2, #2
  44              	.LVL1:
  45              		.loc 1 29 10 view .LVU5
  46 0006 4519     		adds	r5, r0, r5
  47              		.loc 1 29 14 view .LVU6
  48 0008 4118     		adds	r1, r0, r1
  49              		.loc 1 29 10 view .LVU7
  50 000a 2A68     		ldr	r2, [r5]
  51              	.LVL2:
  52              		.loc 1 29 10 view .LVU8
  53 000c 0C68     		ldr	r4, [r1]
  30:./lib/shiffthq/src/chacha20.c ****     x[c] += x[d]; x[b] = rotl32(x[b] ^ x[c], 12);
  54              		.loc 1 30 10 view .LVU9
  55 000e 9B00     		lsls	r3, r3, #2
  56              	.LVL3:
  29:./lib/shiffthq/src/chacha20.c ****     x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a], 16);
  57              		.loc 1 29 10 view .LVU10
  58 0010 1219     		adds	r2, r2, r4
  29:./lib/shiffthq/src/chacha20.c ****     x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a], 16);
  59              		.loc 1 29 34 view .LVU11
  60 0012 049C     		ldr	r4, [sp, #16]
  29:./lib/shiffthq/src/chacha20.c ****     x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a], 16);
  61              		.loc 1 29 10 view .LVU12
  62 0014 2A60     		str	r2, [r5]
  29:./lib/shiffthq/src/chacha20.c ****     x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a], 16);
  63              		.loc 1 29 19 is_stmt 1 view .LVU13
  29:./lib/shiffthq/src/chacha20.c ****     x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a], 16);
  64              		.loc 1 29 34 is_stmt 0 view .LVU14
  65 0016 A400     		lsls	r4, r4, #2
  66 0018 0419     		adds	r4, r0, r4
  67              	.LVL4:
  68              	.LBB10:
  69              	.LBI10:
  22:./lib/shiffthq/src/chacha20.c ****     // http://blog.regehr.org/archives/1063
  70              		.loc 1 22 24 is_stmt 1 view .LVU15
  71              	.LBB11:
  24:./lib/shiffthq/src/chacha20.c **** }
  72              		.loc 1 24 5 view .LVU16
  73              	.LBE11:
  74              	.LBE10:
  29:./lib/shiffthq/src/chacha20.c ****     x[c] += x[d]; x[b] = rotl32(x[b] ^ x[c], 12);
  75              		.loc 1 29 26 is_stmt 0 view .LVU17
  76 001a 2668     		ldr	r6, [r4]
  77              		.loc 1 30 10 view .LVU18
  78 001c C018     		adds	r0, r0, r3
  79              	.LVL5:
  29:./lib/shiffthq/src/chacha20.c ****     x[c] += x[d]; x[b] = rotl32(x[b] ^ x[c], 12);
  80              		.loc 1 29 26 view .LVU19
  81 001e 7240     		eors	r2, r6
  82              	.LVL6:
  83              	.LBB14:
  84              	.LBB12:
  24:./lib/shiffthq/src/chacha20.c **** }
  85              		.loc 1 24 19 view .LVU20
  86 0020 1026     		movs	r6, #16
  87              	.LBE12:
  88              	.LBE14:
  31:./lib/shiffthq/src/chacha20.c ****     x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a],  8);
  32:./lib/shiffthq/src/chacha20.c ****     x[c] += x[d]; x[b] = rotl32(x[b] ^ x[c],  7);
  33:./lib/shiffthq/src/chacha20.c **** }
  89              		.loc 1 33 1 view .LVU21
  90              		@ sp needed
  91              	.LBB15:
  92              	.LBB13:
  24:./lib/shiffthq/src/chacha20.c **** }
  93              		.loc 1 24 19 view .LVU22
  94 0022 F241     		rors	r2, r2, r6
  95              	.LVL7:
  24:./lib/shiffthq/src/chacha20.c **** }
  96              		.loc 1 24 19 view .LVU23
  97              	.LBE13:
  98              	.LBE15:
  29:./lib/shiffthq/src/chacha20.c ****     x[c] += x[d]; x[b] = rotl32(x[b] ^ x[c], 12);
  99              		.loc 1 29 24 view .LVU24
 100 0024 2260     		str	r2, [r4]
  30:./lib/shiffthq/src/chacha20.c ****     x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a],  8);
 101              		.loc 1 30 5 is_stmt 1 view .LVU25
  30:./lib/shiffthq/src/chacha20.c ****     x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a],  8);
 102              		.loc 1 30 10 is_stmt 0 view .LVU26
 103 0026 0368     		ldr	r3, [r0]
 104 0028 D218     		adds	r2, r2, r3
 105 002a 0260     		str	r2, [r0]
  30:./lib/shiffthq/src/chacha20.c ****     x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a],  8);
 106              		.loc 1 30 19 is_stmt 1 view .LVU27
 107              	.LVL8:
 108              	.LBB16:
 109              	.LBI16:
  22:./lib/shiffthq/src/chacha20.c ****     // http://blog.regehr.org/archives/1063
 110              		.loc 1 22 24 view .LVU28
 111              	.LBB17:
  24:./lib/shiffthq/src/chacha20.c **** }
 112              		.loc 1 24 5 view .LVU29
 113              	.LBE17:
 114              	.LBE16:
  30:./lib/shiffthq/src/chacha20.c ****     x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a],  8);
 115              		.loc 1 30 26 is_stmt 0 view .LVU30
 116 002c 0B68     		ldr	r3, [r1]
 117 002e 5340     		eors	r3, r2
 118              	.LVL9:
 119              	.LBB19:
 120              	.LBB18:
  24:./lib/shiffthq/src/chacha20.c **** }
 121              		.loc 1 24 19 view .LVU31
 122 0030 1422     		movs	r2, #20
 123 0032 D341     		rors	r3, r3, r2
 124              	.LVL10:
  24:./lib/shiffthq/src/chacha20.c **** }
 125              		.loc 1 24 19 view .LVU32
 126              	.LBE18:
 127              	.LBE19:
  30:./lib/shiffthq/src/chacha20.c ****     x[a] += x[b]; x[d] = rotl32(x[d] ^ x[a],  8);
 128              		.loc 1 30 24 view .LVU33
 129 0034 0B60     		str	r3, [r1]
  31:./lib/shiffthq/src/chacha20.c ****     x[c] += x[d]; x[b] = rotl32(x[b] ^ x[c],  7);
 130              		.loc 1 31 5 is_stmt 1 view .LVU34
  31:./lib/shiffthq/src/chacha20.c ****     x[c] += x[d]; x[b] = rotl32(x[b] ^ x[c],  7);
 131              		.loc 1 31 10 is_stmt 0 view .LVU35
 132 0036 2A68     		ldr	r2, [r5]
 133 0038 9B18     		adds	r3, r3, r2
 134 003a 2B60     		str	r3, [r5]
  31:./lib/shiffthq/src/chacha20.c ****     x[c] += x[d]; x[b] = rotl32(x[b] ^ x[c],  7);
 135              		.loc 1 31 19 is_stmt 1 view .LVU36
 136              	.LVL11:
 137              	.LBB20:
 138              	.LBI20:
  22:./lib/shiffthq/src/chacha20.c ****     // http://blog.regehr.org/archives/1063
 139              		.loc 1 22 24 view .LVU37
 140              	.LBB21:
  24:./lib/shiffthq/src/chacha20.c **** }
 141              		.loc 1 24 5 view .LVU38
 142              	.LBE21:
 143              	.LBE20:
  31:./lib/shiffthq/src/chacha20.c ****     x[c] += x[d]; x[b] = rotl32(x[b] ^ x[c],  7);
 144              		.loc 1 31 26 is_stmt 0 view .LVU39
 145 003c 2268     		ldr	r2, [r4]
 146 003e 5340     		eors	r3, r2
 147              	.LVL12:
 148              	.LBB23:
 149              	.LBB22:
  24:./lib/shiffthq/src/chacha20.c **** }
 150              		.loc 1 24 19 view .LVU40
 151 0040 1822     		movs	r2, #24
 152 0042 D341     		rors	r3, r3, r2
 153              	.LVL13:
  24:./lib/shiffthq/src/chacha20.c **** }
 154              		.loc 1 24 19 view .LVU41
 155              	.LBE22:
 156              	.LBE23:
  31:./lib/shiffthq/src/chacha20.c ****     x[c] += x[d]; x[b] = rotl32(x[b] ^ x[c],  7);
 157              		.loc 1 31 24 view .LVU42
 158 0044 2360     		str	r3, [r4]
  32:./lib/shiffthq/src/chacha20.c **** }
 159              		.loc 1 32 5 is_stmt 1 view .LVU43
  32:./lib/shiffthq/src/chacha20.c **** }
 160              		.loc 1 32 10 is_stmt 0 view .LVU44
 161 0046 0268     		ldr	r2, [r0]
 162 0048 9B18     		adds	r3, r3, r2
 163 004a 0360     		str	r3, [r0]
  32:./lib/shiffthq/src/chacha20.c **** }
 164              		.loc 1 32 19 is_stmt 1 view .LVU45
 165              	.LVL14:
 166              	.LBB24:
 167              	.LBI24:
  22:./lib/shiffthq/src/chacha20.c ****     // http://blog.regehr.org/archives/1063
 168              		.loc 1 22 24 view .LVU46
 169              	.LBB25:
  24:./lib/shiffthq/src/chacha20.c **** }
 170              		.loc 1 24 5 view .LVU47
  24:./lib/shiffthq/src/chacha20.c **** }
 171              		.loc 1 24 5 is_stmt 0 view .LVU48
 172              	.LBE25:
 173              	.LBE24:
  32:./lib/shiffthq/src/chacha20.c **** }
 174              		.loc 1 32 26 view .LVU49
 175 004c 0A68     		ldr	r2, [r1]
 176 004e 5340     		eors	r3, r2
 177              	.LBB27:
 178              	.LBB26:
  24:./lib/shiffthq/src/chacha20.c **** }
 179              		.loc 1 24 19 view .LVU50
 180 0050 1922     		movs	r2, #25
 181 0052 D341     		rors	r3, r3, r2
 182              	.LBE26:
 183              	.LBE27:
  32:./lib/shiffthq/src/chacha20.c **** }
 184              		.loc 1 32 24 view .LVU51
 185 0054 0B60     		str	r3, [r1]
 186              		.loc 1 33 1 view .LVU52
 187 0056 70BD     		pop	{r4, r5, r6, pc}
 188              		.cfi_endproc
 189              	.LFE3:
 191              		.section	.text.ChaCha20XOR,"ax",%progbits
 192              		.align	1
 193              		.global	ChaCha20XOR
 194              		.syntax unified
 195              		.code	16
 196              		.thumb_func
 197              		.fpu softvfp
 199              	ChaCha20XOR:
 200              	.LVL15:
 201              	.LFB7:
  34:./lib/shiffthq/src/chacha20.c **** 
  35:./lib/shiffthq/src/chacha20.c **** static void chacha20_serialize(uint32_t in[16], uint8_t output[64]) {
  36:./lib/shiffthq/src/chacha20.c ****     int i;
  37:./lib/shiffthq/src/chacha20.c ****     for (i = 0; i < 16; i++) {
  38:./lib/shiffthq/src/chacha20.c ****         u32t8le(in[i], output + (i << 2));
  39:./lib/shiffthq/src/chacha20.c ****     }
  40:./lib/shiffthq/src/chacha20.c **** }
  41:./lib/shiffthq/src/chacha20.c **** 
  42:./lib/shiffthq/src/chacha20.c **** static void chacha20_block(uint32_t in[16], uint8_t out[64], int num_rounds) {
  43:./lib/shiffthq/src/chacha20.c ****     int i;
  44:./lib/shiffthq/src/chacha20.c ****     uint32_t x[16];
  45:./lib/shiffthq/src/chacha20.c **** 
  46:./lib/shiffthq/src/chacha20.c ****     memcpy(x, in, sizeof(uint32_t) * 16);
  47:./lib/shiffthq/src/chacha20.c **** 
  48:./lib/shiffthq/src/chacha20.c ****     for (i = num_rounds; i > 0; i -= 2) {
  49:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 0, 4,  8, 12);
  50:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 1, 5,  9, 13);
  51:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 2, 6, 10, 14);
  52:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 3, 7, 11, 15);
  53:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 0, 5, 10, 15);
  54:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 1, 6, 11, 12);
  55:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 2, 7,  8, 13);
  56:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 3, 4,  9, 14);
  57:./lib/shiffthq/src/chacha20.c ****     }
  58:./lib/shiffthq/src/chacha20.c **** 
  59:./lib/shiffthq/src/chacha20.c ****     for (i = 0; i < 16; i++) {
  60:./lib/shiffthq/src/chacha20.c ****         x[i] += in[i];
  61:./lib/shiffthq/src/chacha20.c ****     }
  62:./lib/shiffthq/src/chacha20.c **** 
  63:./lib/shiffthq/src/chacha20.c ****     chacha20_serialize(x, out);
  64:./lib/shiffthq/src/chacha20.c **** }
  65:./lib/shiffthq/src/chacha20.c **** 
  66:./lib/shiffthq/src/chacha20.c **** // https://tools.ietf.org/html/rfc7539#section-2.3
  67:./lib/shiffthq/src/chacha20.c **** static void chacha20_init_state(uint32_t s[16], uint8_t key[32], uint32_t counter, uint8_t nonce[12
  68:./lib/shiffthq/src/chacha20.c ****     int i;
  69:./lib/shiffthq/src/chacha20.c **** 
  70:./lib/shiffthq/src/chacha20.c ****     // refer: https://dxr.mozilla.org/mozilla-beta/source/security/nss/lib/freebl/chacha20.c
  71:./lib/shiffthq/src/chacha20.c ****     // convert magic number to string: "expand 32-byte k"
  72:./lib/shiffthq/src/chacha20.c ****     s[0] = 0x61707865;
  73:./lib/shiffthq/src/chacha20.c ****     s[1] = 0x3320646e;
  74:./lib/shiffthq/src/chacha20.c ****     s[2] = 0x79622d32;
  75:./lib/shiffthq/src/chacha20.c ****     s[3] = 0x6b206574;
  76:./lib/shiffthq/src/chacha20.c **** 
  77:./lib/shiffthq/src/chacha20.c ****     for (i = 0; i < 8; i++) {
  78:./lib/shiffthq/src/chacha20.c ****         s[4 + i] = u8t32le(key + i * 4);
  79:./lib/shiffthq/src/chacha20.c ****     }
  80:./lib/shiffthq/src/chacha20.c **** 
  81:./lib/shiffthq/src/chacha20.c ****     s[12] = counter;
  82:./lib/shiffthq/src/chacha20.c **** 
  83:./lib/shiffthq/src/chacha20.c ****     for (i = 0; i < 3; i++) {
  84:./lib/shiffthq/src/chacha20.c ****         s[13 + i] = u8t32le(nonce + i * 4);
  85:./lib/shiffthq/src/chacha20.c ****     }
  86:./lib/shiffthq/src/chacha20.c **** }
  87:./lib/shiffthq/src/chacha20.c **** 
  88:./lib/shiffthq/src/chacha20.c **** void ChaCha20XOR(uint8_t key[32], uint32_t counter, uint8_t nonce[12], uint8_t *in, uint8_t *out, i
 202              		.loc 1 88 110 is_stmt 1 view -0
 203              		.cfi_startproc
 204              		@ args = 8, pretend = 0, frame = 200
 205              		@ frame_needed = 0, uses_anonymous_args = 0
  89:./lib/shiffthq/src/chacha20.c ****     int i, j;
 206              		.loc 1 89 5 view .LVU54
  90:./lib/shiffthq/src/chacha20.c **** 
  91:./lib/shiffthq/src/chacha20.c ****     uint32_t s[16];
 207              		.loc 1 91 5 view .LVU55
  92:./lib/shiffthq/src/chacha20.c ****     uint8_t block[64];
 208              		.loc 1 92 5 view .LVU56
  93:./lib/shiffthq/src/chacha20.c **** 
  94:./lib/shiffthq/src/chacha20.c ****     chacha20_init_state(s, key, counter, nonce);
 209              		.loc 1 94 5 view .LVU57
  88:./lib/shiffthq/src/chacha20.c ****     int i, j;
 210              		.loc 1 88 110 is_stmt 0 view .LVU58
 211 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 212              	.LCFI1:
 213              		.cfi_def_cfa_offset 20
 214              		.cfi_offset 4, -20
 215              		.cfi_offset 5, -16
 216              		.cfi_offset 6, -12
 217              		.cfi_offset 7, -8
 218              		.cfi_offset 14, -4
 219 0002 1400     		movs	r4, r2
 220 0004 0D00     		movs	r5, r1
 221 0006 B5B0     		sub	sp, sp, #212
 222              	.LCFI2:
 223              		.cfi_def_cfa_offset 232
 224              	.LVL16:
 225              	.LBB40:
 226              	.LBI40:
  67:./lib/shiffthq/src/chacha20.c ****     int i;
 227              		.loc 1 67 13 is_stmt 1 view .LVU59
 228              	.LBB41:
  68:./lib/shiffthq/src/chacha20.c **** 
 229              		.loc 1 68 5 view .LVU60
  72:./lib/shiffthq/src/chacha20.c ****     s[1] = 0x3320646e;
 230              		.loc 1 72 5 view .LVU61
 231              	.LBE41:
 232              	.LBE40:
  88:./lib/shiffthq/src/chacha20.c ****     int i, j;
 233              		.loc 1 88 110 is_stmt 0 view .LVU62
 234 0008 0293     		str	r3, [sp, #8]
 235              	.LBB44:
 236              	.LBB42:
  72:./lib/shiffthq/src/chacha20.c ****     s[1] = 0x3320646e;
 237              		.loc 1 72 10 view .LVU63
 238 000a 4A4B     		ldr	r3, .L14
 239              	.LVL17:
  78:./lib/shiffthq/src/chacha20.c ****     }
 240              		.loc 1 78 18 view .LVU64
 241 000c 0100     		movs	r1, r0
 242              	.LVL18:
  72:./lib/shiffthq/src/chacha20.c ****     s[1] = 0x3320646e;
 243              		.loc 1 72 10 view .LVU65
 244 000e 0493     		str	r3, [sp, #16]
  73:./lib/shiffthq/src/chacha20.c ****     s[2] = 0x79622d32;
 245              		.loc 1 73 5 is_stmt 1 view .LVU66
  73:./lib/shiffthq/src/chacha20.c ****     s[2] = 0x79622d32;
 246              		.loc 1 73 10 is_stmt 0 view .LVU67
 247 0010 494B     		ldr	r3, .L14+4
  78:./lib/shiffthq/src/chacha20.c ****     }
 248              		.loc 1 78 18 view .LVU68
 249 0012 2022     		movs	r2, #32
 250              	.LVL19:
  73:./lib/shiffthq/src/chacha20.c ****     s[2] = 0x79622d32;
 251              		.loc 1 73 10 view .LVU69
 252 0014 0593     		str	r3, [sp, #20]
  74:./lib/shiffthq/src/chacha20.c ****     s[3] = 0x6b206574;
 253              		.loc 1 74 5 is_stmt 1 view .LVU70
  74:./lib/shiffthq/src/chacha20.c ****     s[3] = 0x6b206574;
 254              		.loc 1 74 10 is_stmt 0 view .LVU71
 255 0016 494B     		ldr	r3, .L14+8
  78:./lib/shiffthq/src/chacha20.c ****     }
 256              		.loc 1 78 18 view .LVU72
 257 0018 08A8     		add	r0, sp, #32
 258              	.LVL20:
  74:./lib/shiffthq/src/chacha20.c ****     s[3] = 0x6b206574;
 259              		.loc 1 74 10 view .LVU73
 260 001a 0693     		str	r3, [sp, #24]
  75:./lib/shiffthq/src/chacha20.c **** 
 261              		.loc 1 75 5 is_stmt 1 view .LVU74
  75:./lib/shiffthq/src/chacha20.c **** 
 262              		.loc 1 75 10 is_stmt 0 view .LVU75
 263 001c 484B     		ldr	r3, .L14+12
 264              	.LBE42:
 265              	.LBE44:
  95:./lib/shiffthq/src/chacha20.c **** 
  96:./lib/shiffthq/src/chacha20.c ****     for (i = 0; i < inlen; i += 64) {
 266              		.loc 1 96 12 view .LVU76
 267 001e 0026     		movs	r6, #0
 268              	.LBB45:
 269              	.LBB43:
  75:./lib/shiffthq/src/chacha20.c **** 
 270              		.loc 1 75 10 view .LVU77
 271 0020 0793     		str	r3, [sp, #28]
  77:./lib/shiffthq/src/chacha20.c ****         s[4 + i] = u8t32le(key + i * 4);
 272              		.loc 1 77 5 is_stmt 1 view .LVU78
 273              	.LVL21:
  77:./lib/shiffthq/src/chacha20.c ****         s[4 + i] = u8t32le(key + i * 4);
 274              		.loc 1 77 17 view .LVU79
  78:./lib/shiffthq/src/chacha20.c ****     }
 275              		.loc 1 78 18 is_stmt 0 view .LVU80
 276 0022 FFF7FEFF 		bl	memcpy
 277              	.LVL22:
  81:./lib/shiffthq/src/chacha20.c **** 
 278              		.loc 1 81 5 is_stmt 1 view .LVU81
  84:./lib/shiffthq/src/chacha20.c ****     }
 279              		.loc 1 84 19 is_stmt 0 view .LVU82
 280 0026 0C22     		movs	r2, #12
 281 0028 2100     		movs	r1, r4
 282 002a 11A8     		add	r0, sp, #68
  81:./lib/shiffthq/src/chacha20.c **** 
 283              		.loc 1 81 11 view .LVU83
 284 002c 1095     		str	r5, [sp, #64]
  83:./lib/shiffthq/src/chacha20.c ****         s[13 + i] = u8t32le(nonce + i * 4);
 285              		.loc 1 83 5 is_stmt 1 view .LVU84
 286              	.LVL23:
  83:./lib/shiffthq/src/chacha20.c ****         s[13 + i] = u8t32le(nonce + i * 4);
 287              		.loc 1 83 17 view .LVU85
  84:./lib/shiffthq/src/chacha20.c ****     }
 288              		.loc 1 84 19 is_stmt 0 view .LVU86
 289 002e FFF7FEFF 		bl	memcpy
 290              	.LVL24:
 291              	.L3:
  84:./lib/shiffthq/src/chacha20.c ****     }
 292              		.loc 1 84 19 view .LVU87
 293              	.LBE43:
 294              	.LBE45:
 295              		.loc 1 96 17 is_stmt 1 discriminator 1 view .LVU88
 296              		.loc 1 96 5 is_stmt 0 discriminator 1 view .LVU89
 297 0032 3B9B     		ldr	r3, [sp, #236]
 298 0034 9E42     		cmp	r6, r3
 299 0036 01DB     		blt	.L10
  97:./lib/shiffthq/src/chacha20.c ****         chacha20_block(s, block, 20);
  98:./lib/shiffthq/src/chacha20.c ****         s[12]++;
  99:./lib/shiffthq/src/chacha20.c **** 
 100:./lib/shiffthq/src/chacha20.c ****         for (j = i; j < i + 64; j++) {
 101:./lib/shiffthq/src/chacha20.c ****             if (j >= inlen) {
 102:./lib/shiffthq/src/chacha20.c ****                 break;
 103:./lib/shiffthq/src/chacha20.c ****             }
 104:./lib/shiffthq/src/chacha20.c ****             out[j] = in[j] ^ block[j - i];
 105:./lib/shiffthq/src/chacha20.c ****         }
 106:./lib/shiffthq/src/chacha20.c ****     }
 107:./lib/shiffthq/src/chacha20.c **** }
 300              		.loc 1 107 1 view .LVU90
 301 0038 35B0     		add	sp, sp, #212
 302              		@ sp needed
 303              	.LVL25:
 304              		.loc 1 107 1 view .LVU91
 305 003a F0BD     		pop	{r4, r5, r6, r7, pc}
 306              	.LVL26:
 307              	.L10:
  97:./lib/shiffthq/src/chacha20.c ****         chacha20_block(s, block, 20);
 308              		.loc 1 97 9 is_stmt 1 view .LVU92
 309              	.LBB46:
 310              	.LBI46:
  42:./lib/shiffthq/src/chacha20.c ****     int i;
 311              		.loc 1 42 13 view .LVU93
 312              	.LBB47:
  43:./lib/shiffthq/src/chacha20.c ****     uint32_t x[16];
 313              		.loc 1 43 5 view .LVU94
  44:./lib/shiffthq/src/chacha20.c **** 
 314              		.loc 1 44 5 view .LVU95
  46:./lib/shiffthq/src/chacha20.c **** 
 315              		.loc 1 46 5 view .LVU96
 316 003c 4022     		movs	r2, #64
 317 003e 04A9     		add	r1, sp, #16
 318              	.LVL27:
  46:./lib/shiffthq/src/chacha20.c **** 
 319              		.loc 1 46 5 is_stmt 0 view .LVU97
 320 0040 24A8     		add	r0, sp, #144
 321 0042 FFF7FEFF 		bl	memcpy
 322              	.LVL28:
  48:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 0, 4,  8, 12);
 323              		.loc 1 48 5 is_stmt 1 view .LVU98
  48:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 0, 4,  8, 12);
 324              		.loc 1 48 26 view .LVU99
  46:./lib/shiffthq/src/chacha20.c **** 
 325              		.loc 1 46 5 is_stmt 0 view .LVU100
 326 0046 0A24     		movs	r4, #10
 327              	.LVL29:
 328              	.L4:
  49:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 1, 5,  9, 13);
 329              		.loc 1 49 9 is_stmt 1 view .LVU101
 330 0048 0C23     		movs	r3, #12
 331 004a 24AD     		add	r5, sp, #144
 332 004c 0422     		movs	r2, #4
 333 004e 0021     		movs	r1, #0
 334 0050 2800     		movs	r0, r5
 335 0052 0093     		str	r3, [sp]
 336 0054 043B     		subs	r3, r3, #4
 337 0056 FFF7FEFF 		bl	chacha20_quarterround
 338              	.LVL30:
  50:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 2, 6, 10, 14);
 339              		.loc 1 50 9 view .LVU102
 340 005a 0D22     		movs	r2, #13
 341 005c 0923     		movs	r3, #9
 342 005e 0121     		movs	r1, #1
 343 0060 2800     		movs	r0, r5
 344 0062 0092     		str	r2, [sp]
 345 0064 083A     		subs	r2, r2, #8
 346 0066 FFF7FEFF 		bl	chacha20_quarterround
 347              	.LVL31:
  51:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 3, 7, 11, 15);
 348              		.loc 1 51 9 view .LVU103
 349 006a 0E21     		movs	r1, #14
  52:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 0, 5, 10, 15);
 350              		.loc 1 52 9 is_stmt 0 view .LVU104
 351 006c 0F27     		movs	r7, #15
  51:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 3, 7, 11, 15);
 352              		.loc 1 51 9 view .LVU105
 353 006e 0A23     		movs	r3, #10
 354 0070 0622     		movs	r2, #6
 355 0072 2800     		movs	r0, r5
 356 0074 0091     		str	r1, [sp]
 357 0076 0C39     		subs	r1, r1, #12
 358 0078 FFF7FEFF 		bl	chacha20_quarterround
 359              	.LVL32:
  52:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 0, 5, 10, 15);
 360              		.loc 1 52 9 is_stmt 1 view .LVU106
 361 007c 0B23     		movs	r3, #11
 362 007e 0722     		movs	r2, #7
 363 0080 0321     		movs	r1, #3
 364 0082 2800     		movs	r0, r5
 365 0084 0097     		str	r7, [sp]
 366 0086 FFF7FEFF 		bl	chacha20_quarterround
 367              	.LVL33:
  53:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 1, 6, 11, 12);
 368              		.loc 1 53 9 view .LVU107
 369 008a 0A23     		movs	r3, #10
 370 008c 0522     		movs	r2, #5
 371 008e 0021     		movs	r1, #0
 372 0090 2800     		movs	r0, r5
 373 0092 0097     		str	r7, [sp]
 374 0094 FFF7FEFF 		bl	chacha20_quarterround
 375              	.LVL34:
  54:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 2, 7,  8, 13);
 376              		.loc 1 54 9 view .LVU108
 377 0098 0C23     		movs	r3, #12
 378 009a 0622     		movs	r2, #6
 379 009c 0121     		movs	r1, #1
 380 009e 2800     		movs	r0, r5
 381 00a0 0093     		str	r3, [sp]
 382 00a2 013B     		subs	r3, r3, #1
 383 00a4 FFF7FEFF 		bl	chacha20_quarterround
 384              	.LVL35:
  55:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 3, 4,  9, 14);
 385              		.loc 1 55 9 view .LVU109
 386 00a8 0D22     		movs	r2, #13
 387 00aa 0823     		movs	r3, #8
 388 00ac 0221     		movs	r1, #2
 389 00ae 2800     		movs	r0, r5
 390 00b0 0092     		str	r2, [sp]
 391 00b2 063A     		subs	r2, r2, #6
 392 00b4 FFF7FEFF 		bl	chacha20_quarterround
 393              	.LVL36:
  56:./lib/shiffthq/src/chacha20.c ****     }
 394              		.loc 1 56 9 view .LVU110
 395 00b8 0E21     		movs	r1, #14
 396 00ba 0923     		movs	r3, #9
 397 00bc 0091     		str	r1, [sp]
 398 00be 0422     		movs	r2, #4
 399 00c0 2800     		movs	r0, r5
 400 00c2 0B39     		subs	r1, r1, #11
  48:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 0, 4,  8, 12);
 401              		.loc 1 48 5 is_stmt 0 view .LVU111
 402 00c4 013C     		subs	r4, r4, #1
 403              	.LVL37:
  56:./lib/shiffthq/src/chacha20.c ****     }
 404              		.loc 1 56 9 view .LVU112
 405 00c6 FFF7FEFF 		bl	chacha20_quarterround
 406              	.LVL38:
  48:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 0, 4,  8, 12);
 407              		.loc 1 48 33 is_stmt 1 view .LVU113
  48:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 0, 4,  8, 12);
 408              		.loc 1 48 26 view .LVU114
  48:./lib/shiffthq/src/chacha20.c ****         chacha20_quarterround(x, 0, 4,  8, 12);
 409              		.loc 1 48 5 is_stmt 0 view .LVU115
 410 00ca 002C     		cmp	r4, #0
 411 00cc BCD1     		bne	.L4
 412 00ce 2A00     		movs	r2, r5
 413 00d0 2300     		movs	r3, r4
  60:./lib/shiffthq/src/chacha20.c ****     }
 414              		.loc 1 60 19 view .LVU116
 415 00d2 04A8     		add	r0, sp, #16
 416              	.LVL39:
 417              	.L5:
  60:./lib/shiffthq/src/chacha20.c ****     }
 418              		.loc 1 60 9 is_stmt 1 view .LVU117
  60:./lib/shiffthq/src/chacha20.c ****     }
 419              		.loc 1 60 14 is_stmt 0 view .LVU118
 420 00d4 1168     		ldr	r1, [r2]
 421 00d6 1F58     		ldr	r7, [r3, r0]
  59:./lib/shiffthq/src/chacha20.c ****         x[i] += in[i];
 422              		.loc 1 59 5 view .LVU119
 423 00d8 0433     		adds	r3, r3, #4
  60:./lib/shiffthq/src/chacha20.c ****     }
 424              		.loc 1 60 14 view .LVU120
 425 00da C919     		adds	r1, r1, r7
 426 00dc 02C2     		stmia	r2!, {r1}
  59:./lib/shiffthq/src/chacha20.c ****         x[i] += in[i];
 427              		.loc 1 59 25 is_stmt 1 view .LVU121
  59:./lib/shiffthq/src/chacha20.c ****         x[i] += in[i];
 428              		.loc 1 59 17 view .LVU122
  59:./lib/shiffthq/src/chacha20.c ****         x[i] += in[i];
 429              		.loc 1 59 5 is_stmt 0 view .LVU123
 430 00de 402B     		cmp	r3, #64
 431 00e0 F8D1     		bne	.L5
 432 00e2 0021     		movs	r1, #0
 433 00e4 14AB     		add	r3, sp, #80
 434              	.LVL40:
 435              	.L6:
 436              	.LBB48:
 437              	.LBB49:
  38:./lib/shiffthq/src/chacha20.c ****     }
 438              		.loc 1 38 9 is_stmt 1 view .LVU124
 439 00e6 6A58     		ldr	r2, [r5, r1]
 440              	.LVL41:
 441              	.LBB50:
 442              	.LBI50:
   5:./lib/shiffthq/src/chacha20.c ****     p[0] = v & 0xff;
 443              		.loc 1 5 20 view .LVU125
 444              	.LBB51:
   6:./lib/shiffthq/src/chacha20.c ****     p[1] = (v >> 8) & 0xff;
 445              		.loc 1 6 5 view .LVU126
 446              	.LBE51:
 447              	.LBE50:
  37:./lib/shiffthq/src/chacha20.c ****         u32t8le(in[i], output + (i << 2));
 448              		.loc 1 37 5 is_stmt 0 view .LVU127
 449 00e8 0431     		adds	r1, r1, #4
 450              	.LVL42:
 451              	.LBB53:
 452              	.LBB52:
   7:./lib/shiffthq/src/chacha20.c ****     p[2] = (v >> 16) & 0xff;
 453              		.loc 1 7 15 view .LVU128
 454 00ea 100A     		lsrs	r0, r2, #8
   6:./lib/shiffthq/src/chacha20.c ****     p[1] = (v >> 8) & 0xff;
 455              		.loc 1 6 10 view .LVU129
 456 00ec 1A70     		strb	r2, [r3]
   7:./lib/shiffthq/src/chacha20.c ****     p[2] = (v >> 16) & 0xff;
 457              		.loc 1 7 5 is_stmt 1 view .LVU130
   7:./lib/shiffthq/src/chacha20.c ****     p[2] = (v >> 16) & 0xff;
 458              		.loc 1 7 10 is_stmt 0 view .LVU131
 459 00ee 5870     		strb	r0, [r3, #1]
   8:./lib/shiffthq/src/chacha20.c ****     p[3] = (v >> 24) & 0xff;
 460              		.loc 1 8 5 is_stmt 1 view .LVU132
   8:./lib/shiffthq/src/chacha20.c ****     p[3] = (v >> 24) & 0xff;
 461              		.loc 1 8 15 is_stmt 0 view .LVU133
 462 00f0 100C     		lsrs	r0, r2, #16
   9:./lib/shiffthq/src/chacha20.c **** }
 463              		.loc 1 9 15 view .LVU134
 464 00f2 120E     		lsrs	r2, r2, #24
 465              	.LVL43:
   8:./lib/shiffthq/src/chacha20.c ****     p[3] = (v >> 24) & 0xff;
 466              		.loc 1 8 10 view .LVU135
 467 00f4 9870     		strb	r0, [r3, #2]
   9:./lib/shiffthq/src/chacha20.c **** }
 468              		.loc 1 9 5 is_stmt 1 view .LVU136
   9:./lib/shiffthq/src/chacha20.c **** }
 469              		.loc 1 9 10 is_stmt 0 view .LVU137
 470 00f6 DA70     		strb	r2, [r3, #3]
 471              	.LVL44:
   9:./lib/shiffthq/src/chacha20.c **** }
 472              		.loc 1 9 10 view .LVU138
 473              	.LBE52:
 474              	.LBE53:
  37:./lib/shiffthq/src/chacha20.c ****         u32t8le(in[i], output + (i << 2));
 475              		.loc 1 37 25 is_stmt 1 view .LVU139
  37:./lib/shiffthq/src/chacha20.c ****         u32t8le(in[i], output + (i << 2));
 476              		.loc 1 37 17 view .LVU140
  37:./lib/shiffthq/src/chacha20.c ****         u32t8le(in[i], output + (i << 2));
 477              		.loc 1 37 5 is_stmt 0 view .LVU141
 478 00f8 0433     		adds	r3, r3, #4
 479 00fa 4029     		cmp	r1, #64
 480 00fc F3D1     		bne	.L6
 481              	.LVL45:
  37:./lib/shiffthq/src/chacha20.c ****         u32t8le(in[i], output + (i << 2));
 482              		.loc 1 37 5 view .LVU142
 483              	.LBE49:
 484              	.LBE48:
 485              	.LBE47:
 486              	.LBE46:
  98:./lib/shiffthq/src/chacha20.c **** 
 487              		.loc 1 98 9 is_stmt 1 view .LVU143
 100:./lib/shiffthq/src/chacha20.c ****             if (j >= inlen) {
 488              		.loc 1 100 9 is_stmt 0 view .LVU144
 489 00fe 3200     		movs	r2, r6
  98:./lib/shiffthq/src/chacha20.c **** 
 490              		.loc 1 98 14 view .LVU145
 491 0100 109B     		ldr	r3, [sp, #64]
 100:./lib/shiffthq/src/chacha20.c ****             if (j >= inlen) {
 492              		.loc 1 100 9 view .LVU146
 493 0102 3F32     		adds	r2, r2, #63
  98:./lib/shiffthq/src/chacha20.c **** 
 494              		.loc 1 98 14 view .LVU147
 495 0104 0393     		str	r3, [sp, #12]
 496 0106 0133     		adds	r3, r3, #1
 497 0108 1093     		str	r3, [sp, #64]
 100:./lib/shiffthq/src/chacha20.c ****             if (j >= inlen) {
 498              		.loc 1 100 9 is_stmt 1 view .LVU148
 499              	.LVL46:
 101:./lib/shiffthq/src/chacha20.c ****                 break;
 500              		.loc 1 101 16 is_stmt 0 view .LVU149
 501 010a 3B9B     		ldr	r3, [sp, #236]
 502 010c 991B     		subs	r1, r3, r6
 104:./lib/shiffthq/src/chacha20.c ****         }
 503              		.loc 1 104 20 view .LVU150
 504 010e 3A9B     		ldr	r3, [sp, #232]
 505 0110 9819     		adds	r0, r3, r6
 104:./lib/shiffthq/src/chacha20.c ****         }
 506              		.loc 1 104 24 view .LVU151
 507 0112 029B     		ldr	r3, [sp, #8]
 508 0114 9D19     		adds	r5, r3, r6
 509              	.LVL47:
 510              	.L7:
 100:./lib/shiffthq/src/chacha20.c ****             if (j >= inlen) {
 511              		.loc 1 100 21 is_stmt 1 discriminator 1 view .LVU152
 100:./lib/shiffthq/src/chacha20.c ****             if (j >= inlen) {
 512              		.loc 1 100 9 is_stmt 0 discriminator 1 view .LVU153
 513 0116 A319     		adds	r3, r4, r6
 514              	.LVL48:
 100:./lib/shiffthq/src/chacha20.c ****             if (j >= inlen) {
 515              		.loc 1 100 9 discriminator 1 view .LVU154
 516 0118 9A42     		cmp	r2, r3
 517 011a 01DA     		bge	.L9
 518              	.L8:
  96:./lib/shiffthq/src/chacha20.c ****         chacha20_block(s, block, 20);
 519              		.loc 1 96 28 is_stmt 1 discriminator 2 view .LVU155
  96:./lib/shiffthq/src/chacha20.c ****         chacha20_block(s, block, 20);
 520              		.loc 1 96 30 is_stmt 0 discriminator 2 view .LVU156
 521 011c 4036     		adds	r6, r6, #64
 522              	.LVL49:
  96:./lib/shiffthq/src/chacha20.c ****         chacha20_block(s, block, 20);
 523              		.loc 1 96 30 discriminator 2 view .LVU157
 524 011e 88E7     		b	.L3
 525              	.L9:
 101:./lib/shiffthq/src/chacha20.c ****                 break;
 526              		.loc 1 101 13 is_stmt 1 view .LVU158
 101:./lib/shiffthq/src/chacha20.c ****                 break;
 527              		.loc 1 101 16 is_stmt 0 view .LVU159
 528 0120 8C42     		cmp	r4, r1
 529 0122 FBD0     		beq	.L8
 104:./lib/shiffthq/src/chacha20.c ****         }
 530              		.loc 1 104 13 is_stmt 1 discriminator 2 view .LVU160
 104:./lib/shiffthq/src/chacha20.c ****         }
 531              		.loc 1 104 20 is_stmt 0 discriminator 2 view .LVU161
 532 0124 14AF     		add	r7, sp, #80
 533 0126 2B5D     		ldrb	r3, [r5, r4]
 534              	.LVL50:
 104:./lib/shiffthq/src/chacha20.c ****         }
 535              		.loc 1 104 20 discriminator 2 view .LVU162
 536 0128 E75D     		ldrb	r7, [r4, r7]
 537 012a 7B40     		eors	r3, r7
 538 012c 0355     		strb	r3, [r0, r4]
 100:./lib/shiffthq/src/chacha20.c ****             if (j >= inlen) {
 539              		.loc 1 100 33 is_stmt 1 discriminator 2 view .LVU163
 540              	.LVL51:
 100:./lib/shiffthq/src/chacha20.c ****             if (j >= inlen) {
 541              		.loc 1 100 33 is_stmt 0 discriminator 2 view .LVU164
 542 012e 0134     		adds	r4, r4, #1
 543              	.LVL52:
 100:./lib/shiffthq/src/chacha20.c ****             if (j >= inlen) {
 544              		.loc 1 100 33 discriminator 2 view .LVU165
 545 0130 F1E7     		b	.L7
 546              	.L15:
 547 0132 C046     		.align	2
 548              	.L14:
 549 0134 65787061 		.word	1634760805
 550 0138 6E642033 		.word	857760878
 551 013c 322D6279 		.word	2036477234
 552 0140 7465206B 		.word	1797285236
 553              		.cfi_endproc
 554              	.LFE7:
 556              		.text
 557              	.Letext0:
 558              		.file 2 "/usr/lib/gcc/arm-none-eabi/10.3.1/include/stdint.h"
 559              		.file 3 "<built-in>"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 chacha20.c
     /tmp/ccIOwv1E.s:16     .text.chacha20_quarterround:0000000000000000 $t
     /tmp/ccIOwv1E.s:23     .text.chacha20_quarterround:0000000000000000 chacha20_quarterround
     /tmp/ccIOwv1E.s:192    .text.ChaCha20XOR:0000000000000000 $t
     /tmp/ccIOwv1E.s:199    .text.ChaCha20XOR:0000000000000000 ChaCha20XOR
     /tmp/ccIOwv1E.s:549    .text.ChaCha20XOR:0000000000000134 $d

UNDEFINED SYMBOLS
memcpy
